#!/bin/bash

test -n "$1" && subject="$1"

[[ -d $JOURNAL_PATH ]] || mkdir -p "$JOURNAL_PATH"
cd "$JOURNAL_PATH" || exit

existing="$(find . -iname "*${subject}*.md" | menu)"
if [ -f "$existing" ]; then
	subject=$existing
else
	subject="$subject.md"
	test -n "$2" && group="$2/"
	[[ -d "$group" ]] || mkdir "$group"
fi

vi "$group$subject"

git add "$group$subject" \
	&& git commit -qnm "$subject - $(date +%F)"
cd - 1>/dev/null || exit
